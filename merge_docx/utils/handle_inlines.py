import docx
import os
# Unique filepath
import random

EMF_PH = b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\xc8\x00\x00\x00\xc8\x08\x03\x00\x00\x00\x9a\x86^\xac\x00\x00\x00\x96PLTE\xfc\xfe\xfc$F\x8c,F\x94,J\x94l~\xb4\x9c\xaa\xccdz\xb4d~\xb4\x9c\xaa\xd4|\x92\xbc\xf4\xf6\xfc\xac\xba\xd4\xd4\xda\xecTj\xac\xac\xba\xdc\xa4\xae\xd4\xfc\xfa\xfc\xa4\xb2\xd4\xac\xb6\xd4\xb4\xba\xd4\xcc\xd2\xe4\xec\xee\xf4\xb4\xbe\xdc\\r\xac\x9c\xa6\xcc\xf4\xf2\xf44V\x9c\xa4\xb2\xdc,N\x94\xac\xb6\xdc\xec\xee\xfcTn\xa4Lf\xa4|\x8e\xbcDb\xa4\x8c\x9e\xc4d~\xac\\v\xac\x84\x96\xc4D^\x9c<Z\x9cl\x82\xb4\xd4\xde\xec\xe4\xe6\xec\xcc\xd6\xf4Lj\xa4t\x8a\xbc\xbc\xc6\xdc\xe4\xea\xfc\xc4\xca\xec\x8e\xc2\n5\x00\x00\r]IDATx\x9c\xed\\\rW\xdb:\x0f\xc6N\xdbt\xfd\x80\xb6P(]\x07]y\xc7\x18l\xd0\xfb\xff\xff\xdc\x9b\xc4\x1fzd\xbb\x1f\xe7F\x87\xec\x9ec\x15\x92\xd6Q\x1cK\x8f$\xcb\x8e\x93\x8b\x8bL\x992e\xca\x94)S\xa6L\x992e\xca\x94)S\xa6L\x992e\xca\x94)S\xa7\xb4\xea\xf5\xca\xbf\xe5o\xd5F\x90\x9e\xfa{\xa8\xd7R\x10\xdd|\x82\x8d\x8e\x8aYY\xaaX\xabh\x17q\xe8\xd4\x89nS\xb6\x11\xa4\xd4F\x1b\xdao\xec\x16H\xc7?\xf5\x11F\x1d\xb0E\x94\xa8\xaf\xd9H B\xf5i\x15\xa8\xdb\x15k\xcfI\x8d\x0c\xe1\xa3Vi\xce\x86\x18\xa9\xa0\xc4oZ!\xd2S\xd8\xfe\x10\x1c\x05\x8d\x87&\x04\xbcL\xb7\xbeyL$E?4?\t.\xdd\n\x91\x12\xb4\xee\xf5\xca\xd4\xa9Xy\x08\x1e\xf3\x06\xdeh~v\xd4z8\xc1\x9e\xde\xd6\xb4\x12\x8a\x0b\x8c\x82\x95\xb3]\xe8+\xdc\xc8t\xf2Xx%\xff{\xd0N\x100|\xb0c\xe6\xaa\x0c\t&(\xa0\x13)\x83T\x1d"B%\xec\xd2-M\xcbU\xc4Z\x10\xe2\x91\x16%\x02\x04| 0\xa6\x94\xb4\xcc\\U\xeb\xa8\x85\x96\x80\xad\xd7p}\x10\x86\x0e\x06\xae\xa5\x03-\xf0\x80\x06\x8a\n\xe3\x95/\x12\x89Z\x81z\x03\xff\xe0\xa2\x81(\x01\x1a\xa0\x85\x03x\x84U`Yk\xd3B{\x08\x1d\x04\xa2\xa9\xc6\x9f\x11\x07;\'\x02\x04\xc5\xc1?\xf4\xb0\xf6\xa6\x05\xa8\x17\xa7I\xdb\x7f\t6\xc0N\xb7\xef\xd9\xc1\x1e\xca\xe1\xf0z8\xbc\xba\xac\xfe\xbf\r\x87\xf3\xea\x7f\xf1u8\xfc6\x1f\xae.\xaf\xea\xff\xd5\xb0:4\xbc\x1d\xd6l+\xcf\xb6\xa8\xd9\xfa+d\xbbm\xd8\xfa\x15{\xcd\xb6\x9aSm}d\x1b@\\h\x9bk\xa1!\x14\xc36U\xfd\x0b\xea\x17\x10\xbf%\x10\xb1\xd2\x14\xb7R-<\x93\xfa\x05\xba{{\x1fq~\xf7\xe9\x88\\\x15\x18\xbe[\xf5\xec%F\xc4\xa2/\xd5\xc23\xe9\xba\xc0\x08\xdd\xb2\x1f\x81\x18\xd9\x85\x8f\x00"\x02I\xa3\xa5OG\xc4;{C-M\xabK\x1f\x99\x17\xae\x03\x93\x8aZ\x1d\xf9\xc8\xb8\xc0\xb4\xabu\x1a\xef\xbb\xc4\xe2J\xaa\x85gR\xbf\x80\xccE$\xd7\xb2>r)\xd5\xc23\xc9\xfa\x88\x1c"\x16\x92O7\xady\x81\xfd\xb1\x94\x8ft\xe0\xec\x8b\x02S\xe8vQ\x8b\\\xa4\x03D\xd0\xb4$\xe6\xb5:C\x04\x9d\xbd\xb5\x8f\xc0\x08\xe8\xd3\x11Y\x148\xecj=\xaf\xd5]\xcf\xbe(\x00\x10\tD\x9c\x8f\xcc\xa5Zx&a\x1a/\x91k9P\x8aoR-<\x93\\\xaee\xec\xab}\xae\xd5Y?\xb2\xa04^0\xd7\xea&i\x84I\xb1\xf6=;\xebGf7_,}\xaf>\xcd\x0e\xe9\x06\xcf^.\xec\xd1\xef!\xdb\xac9>Z\xb9b_\x13c{dSe\x02S\xa6\x88\xc8h\x01c\xad\xf8\xc3n\xf4\xdd\xec\x0ep\xa9\x91\x11\xf4\xf1h]\xc1,e\xdb\xa8E3l\xc5\xca\x08r\x8c\x9eft\xf2\xf2)\x9cO\xf4\xfa\xf5\x82\x9cG\x12\xa6\xe5\xc3\x96\x8e\x10I\xa9\xee\tN\x9e\xfc\x0c\'x\xfd\x14\xd9\xbd\x11d\x1b\x96\xa7\xf0\xb0\x7f-M\x0b\xa6-M\xf8\x05Dt\xfcM\x03"\xf7}\x95D\xa4.\xb4\x88\xfc\x89\x0e$\x7f\xca\x98\x96\xf2YB3\xb0j\x04\t5H%\x80\xc8??U\x04\x9aS\x8b3-\x0e\x08t\xbe\xa4>?\xe1,`Z\x0e\x91\xbe\x15\x84\xcfF+(\x00D\x96_\x98\x8e\xa1\xa1\xd5\xbf\x11\xe4\x01\x11\xd1\x01$\x1a\x8beL\xcb\xb5\xc1\xf9\x08\xa1\x84J6\\\x84\xc8d\xcdTLs\xb8\x8a\xa2\xd6\x96\x83\xca\x11$S\x102-_\xa5C\x84\x03\xa2\x11\x10\xe5\x87\xf5\xcb\xef\xd4\x10\x86H\xb3\xb5\xce\xfeG\xa7\x0e\xf3\x12o\x96"\xe1\xb7\xa9\x97\x10A@\xe0r\x15\r\xadi\xcdn7pD\xf3\x96A?Bz\xd0\x8c\x9f\tfv\xedG\x88\xae*\x83\xc8\xf5\xe3t\xba{\x9c\xfe\xc4|\xae\xa2\xf5\xb6*\x9eN]\x82\xbc\x7f\x84ch7\xe6\xbbA\xe4\xfe\xb9\xaai\xbb\x06Kr\x95U5U\xb5\xed\x10\x10\xa1\x95\x0f\xda\xf9\xc8\xc5h\xb9|[\xee\x97W`\x15\xf5g\xb8\x7fxx{X\x1aU_\xcc\xae\x11,\xdf\x16\xe5\xa4\xb7l\x0f\xcb\xb7\x87\x8f\x1d\x1a\x95\xa9\xec\xeb~YW6,\xfc)\x02\xa6E\x97a\xb7\x15\xc6\xccl\x94\xba\xba\xc7\xf3\xde\xfe(\xb2\x1a\x0c\x08\xf6;1\x8f\x9a\xcc\x90W6\xd8\x1b\x03]\xc9\xa6\xf1>\xd6\xb0\xec\xf7\x1a\xac\xa6\xf1\xf2\x11\x1c\x9c\xdd2\x15\x07\x88h\xd7\xb3\xd7\xf4\xfa\x08xX\xb6o\xf6p\x9fn\xbe\xc9D-[\x13\x1b\x8f\\r\xb7T_Q\x90\xa5ON\x12\x88\xd4\xe4\x99G\x8b\xb0kU\xfanb\x0f\xde\xfa\xc9\x07\x01\xd3\x82\x18\xcf\x10\x19\x1fAd\xd6\xe7\xc78"\xf5\xc7#\xd2\xd8 !\xd2p}\xb8\x83\xfd\x02*\x90Y\xf9\x10#r\x1d\xf8\x08"\xb2\xdcPO\x19B\xc2\x11\x19\xcd]_O\'x@`:H\xc2\xb4\xa8\x0f`\x88\\\x06\x81\x06\x101\x80\x04\x11\x15\xba\x1eM\x82\xbcm\t\x10\x97\x04x@\xfc\x8d\x1eS\x97T\xd2\x18\x8c\xd9\xc7AC\x01\x91\xe5\x06\xa4\x07&\x10\xca\x9aV\rHP\x8f*_}E\xb74\xd3\xd8\x16\x91\xd2kK\'|\x04\xad\x9e\x10\x99={)\xd0\xe1Y\xcaa\x99\xf7[t\x10s\x10b|\x9f9{\xeb\xb5(\xfeB\xac\x1f\xb9&\xd3nh\xee\x05Y\xbe\xf0CQ\x0e\xa8\\?2\x1b\xa3\xbc\xe6+\x00R\tB\xfd\xba\x8c\x8f\xd8\x96\xb0\xf0\xcb\xd4\xa8\x00\x91\'\x00\x04\xc5\x81\x16\xdb4>\x01H\x81Ac^\xe0!\x89\xd9x\xb3\t:D\xdeL\xdf\x80\xb75yH\xd8}pDf\xe3X\xe0\xc1\x04\xae1\xde\xe0\xd9Ri|\xe8\xec\x1c\x10oZ\xb3wB\x90\x99\x93\x86\x8f\xf1\x91=\x84,\x07\x08\xbb)f\xa2\x96\x08"=lK\x84\x08\xda\x8d3\xad\t\x8b\xa6\xdc\x01\xa8\xc95"\x0e\x10\xf4\x10\x06\x08\xcd\xfd6\x07%f\xe3\x0f\xfb\x88\xefy\xadi\xcd~\x91Gp\xff\xd6\xc0\xdc \xf2\x16\x03\xb2\xe1\xb3\xcb6\x9fT2\x1d")8\x81\x88o\xa3C\xe4\x1fwK#\nZ \x90\xf1\x91y,\xef\xe0\x95]}\x0c\x88\x88\xdd\x9e\xae\r\x18oO\x8f9 V\x90\xfbGh\xad\x0e\xa5\xa1t\xa4b~\xdb!K\xf3e\xc32O\xef#\xf6\xb4\xd6\x8bj|\x0cb\x9ex\xc9\x00q\xa6uY\x80\x9ac@\xbc\xbd\xdf\xa7\x01\x99\xf0\xab\xf7\xa5\x11q\xc2\x84Q\x0b\xc3R\x83\xc8\xc3#$\x1c\xcc\xa24T\xd4\xf8\xc8r\x87\x16h\x00\x19\xce\xf8\xd5\xfd\x98K\xcaG\xf4\x01\x1f\xc1\xa8\xd3 \xb2\xd80\xbf\xf1\x16\x05\x11\xc3\x88x\x7f\xd1\xf7\xe8x!{\x01 \xccG\x84\xee!\x1a\x1fI \xe2\x1b^#\xb2\x7f,\x02w\x00Dp\xa7\xee\x1f\xb6\xa4\x05\xbb\xdb|\r\xaf\xde/0\x92\xcb \xd2\xf8H\x12\x11HQ\xfa\x1b\xd6r\xd6\x05\xc2\xb6\xfa<\xf4I\x0b\xa9,\xcb\tBW\x97\xf4\x91"\xecG\xb0\x93\xa8\x04\xd9\xef\xc89\x92\x88P\xc9~\xc7|\xa7\xde\xae\xe3%;\x8b\x02Oo\xbf\x14\xd05"\x81\x08i\xbc\x12\xe4i\xc3\x8d\x88\xcb\x84.\xa5\x9e@T{Bo\x9f\x12\x84\xf0\x14Y\xc0ls-\xbc=M\xe3\x11\xe7#\x93-h\x99E\xad@\x94j\xf3\x02\xd6g\xf8\x13\x80\xf8\xf1\x88\x88iAs\x8b\x05\x1c\xf1\xd9\xafm\xcb\xd5\xe8\xfb\xc6\xeb\x0f\xcd?\x08c\xdc1\xa8\xfa\xb0\x0f\xb1\x82\xc8u\x88\xd01\x04cv\xee\x00W\x1f\xdb\x14\x02\xa0\xf8\x00\x16\x0e\xdd:\xecCjZ\xf8\t:\x01\xd3\x82\xf6\x84cv\x8cHj\xf8\xbe\xc1\xa6y\xfb\x07\x0c\x144K\xa3\x9c\xb5\xbac\x0f\xa1\xf5Z\x02\x88\xf0\xa5\x80\x87\xe7\xb5\x94\xfa\xf5\x93G1\xb2\x1e.J$\x92\x01$\xf9\xd8\xa7\xedG$\x9c\x9d/\x05\xe4\xf3Z\x14\x94\xea/k\x1e\xc44\xb6]+\x8e\x05n\x8f\x00\xc2\x96pH\x0c\xacN\xf8\x08i^S\x11\n\x00;D\x04D[\xa7\xd7T\x8c\x0b<\xaf\xfdP\xd7\xb7\xf3\x88\x8f$\xfc\x97\xb7\x17\x0e"^f\x7f\x17u\xeaN\x10P\x91\xe0\xediL\xe3C\x1f\xe1_\xfc^\xbf\xfc\tDE\xfc\x8e\x85\xac\x0b?\xf7kO\x92B$X\xf7\xeb\xc7\xec:\x90\x81!\xa2_\x9e\x07\'\x01QwI\x0f\xf1\x1d\xa2\xadQbM\xa3U^r\xcc\x8e\xad\x8b\x10)\xde?\x06\xdcC\x18\x939{\xfd\x94\x06\xa4Y\x89MACd^\xab\xf9K\x8e\xd9\xb9\xa3\xa3\xd3\xd4\xfb\xed\xc7\xfe\x97\n\x8e\x01\x93\xa1\xbb\x87\x03W\x9f\x17(\xb2\xcc*\xd3\xa6\xb2x^\x0b:\xbf\x14"\x9b\xe7\xd1+[<\x11u&\xd5\xee@\xc8\xba\x00\x1fi\xae!\xe1#\xa6\xb1\xe1\xad7\x1e]S\x88L\x7f_L\x06(\xa7\x8e\xf0\xd0jz\x08\x10\xf2\x11\x01\xd3\x02@\xe2\xf1\x08\xfa\x0f \xe2\xf5\xbf^\xcd.&\xff\xe3\x88\x00 \xa6\xf40 \xf5\x13=\x80\x88\xf4\xediKc\xb8\x04\xb6\x0f\xfd\xa1\xacF\x8d\x93\x81W\x05\x97\xd7\xe14\x1d\x1d\xbc\xba\xec\x1d+2\xec\xf0\xf6t\xe8\x1f\xdc\xcf\x95z\xa9\xe7\r\'e\xd0+\x92\xc0M\xc1\x11@\xe8\x8e\x95\x80ia:\x9b\x1e!2\xbb\xc1\xfeD\x97uTmLKq!\xc1\xf3\xf5\xf6@\x1fb\x05\x01D\x84\x9e\xb1\xd2\xb1\x8f@\xa3R.\xb2kn\x06NJE\xb8\xc56\xb89\xb6r\x95n\xbd\t&\x8d*\x8eZ\nd\xe0\xedk<\xea\xbd\xe1{{\x87*\xd0\x04\xcd\x97\xed\x81\xbe\xb0!\x98\x0eR\xeds-Rg0\xaf\xa5\x99\x0c\x88H\xb3\xdd\x99Dp2\x00L\x11_}\x12\x10x\xecB\x02\x11j\xc4aD\x988f\xb3y6|\x95\x8fh\xe0\xc2^\xa4\x06\xe4\xe8\xd5\xfbt[A\x89\xacE\xb1\xb5\x05>\x82)c \x8f\xa2nn2\x00LQ-\xf5fs\xfc\xf1\xb3\xeb\x02+\x17qv\x93\xc6\x07\xfdH\x18\xb3 \x12\xab\xb5\x9b\xff\x9c\x94*D\x04\xcc\xef`\xa7\xde\x10\xcd\xa2H\xa4(\xa4\xe8\xb8\x1f!}\x05]\x85\xfe\xe1\xf8l\xcf\x0e\x07\xa9\'=\xf5<`_\x0e\x11\xb6`@GkQ\x02\x1f\xf6\xbd\x97^{\x99m\xae\xa5a\xeb\x05;\x01\x08\xdeVh\xeb#l\xa8\x1b\xafE!\x83\x816\xd6?~y\xbe\xd7\x1e\x88I\x0c\x91\xa9\xa6h\xbc\x11\xf4\x11\xe8\x90\xe3\xb5(\x8a\xc4 \xa3\xa9\xf6kzh\xe1\xf5\x1dC\x15\x0f\xd0\xa7\xae\x0e\xd3Am}\xa4D\xd3\t\xe7\xb5\xb8_\x80\xc2\xf5\x17\xe2\x9b\xf8\x07\x1eP\xd8\x86\xeb\xe4\x13\xb3\xa2\xafJ\xf0\xb1_G\xeb\xb5\xb8\xb3C\x00\xdb\xc1\xa4H\xe3#0\x14!\x91N\x02BOO\xcb\xf8\x88\x87\x84\xfbH\x18\xa9H\xe1,\x18\xd9\xa41FD\x9f~\xf2\xd7>=m\xf5 \x10\xb5t\xa2\x81\x14~}W\xe8\x8ck\x80\xc1hRR\x7f\xce\xc6W\xa7\x01\x81\x11\xa2\x18"&Ea\xf3Z\x98\x92C\xd2Q\xf5\x0e\xec\xf1\xa4IIXx\x1f\xaa?\xd1\x1d\xc3\xa4 `\xb4"Q\xcb\\;\xb5\xa8\x06\x0c,\xa9\xb9(\xd7\xb2\xf4\xf3D\x1fR\x13\xcc\xa2\x08D-@$\x9a|`\t\x87m\xee\xfa7\xab\xe1\xb5\xa7"\xd8\xce\x04\xc4\xce\xfd\xca#\x12%\x8d\x04\x08\x08\xf5\xcckx\xfd\xc5\x10q\x12\xbd\x9csu\x97\xa2hi\x1f\t\x93F\x10\xc27q\x1d\x0c]\'l\x15\x88?\xe3\xac\x87L\xfbr\x88\x94\x1aZ\x90Zx\x86\x99I\xc3\x17\xa6\x1dA\xf6k\xab\xdb\x1d\x1b\x18zZ\x14(\xbb\xcc\x9a\xc6\x08\x91\x9b\xbb\x8a\x06?\xee\xa6\xf5\xa7\xdaM\xeb\xbf\x1f\xd3A\xe8\xc3oOw\x8f?\x80\xad\xa6\xc1\xf4\xf2\\A\xe4|\x04l\x8b\xdd\x9e^~\xdc|\xdc8\x9a\xfc\xb6\xfb\x9b\xe8\xde\xec\xe8\xb5.6\xf4\xdb\xb1\xdf\x9c\x11\xb2.\xc2\x97 \xb5\x9f\x0er\x0e\xd7\xc9\xd3\xd3d\xb6Rc\xf6n\x9e\x9e\xf6\x81Djq\xa6\x0e}\xe43h\xcen\xbd\t<ce%\xe9\xe2-\x1c\xd0\x8bJ\xad\xc4\xee\xf6\xd5m\x02\xa6Eq\xa3\x83\x97 ag*\xb5\xee\xb7\x03D\xc6l\xe5\x83\xe0\xc0\xaa\x93\xf0\xeb//8\xf9\xd0\xc1k\xa9\xc0 d\xd6\xfdv\xd2\x8f\x8c%\xc7\xec\x88H\'o\xe1\x90A\x84\xfbH\x17os\x92\xcb\xb5`:\xa8\x9b\xd7\x1b\xba\xeb\xcb\xbd\x96J\x7f6"\xd7r\x88\xf4\xd4_\x83H{\xd3"\x1f\xe9\xe4\xa5\xac>\xff\x96\xcb\xb5\xd4\xddm\xbf\xa1\xf9\xd8\xec\x17\x0b\xb3\x1f\xcf\xcd\xde\x1e\xeeK\xb1\x95\xb8\xd4^f<b!\xf9d\x02\x0f\x110-\rJ\x89\tM\xef \xe9\x7f\xc9G\x99o\xfd/\xf7RVM\x7f\xfcn\x9b>\xf1ag\x1fc\xf3\xac\xd1\xf4\xbdL\xd2\x88\r\xe2z\xd5q\xd1aU\x9fb\x85\x89/VjK\xe4^\xa6G(\x83d\x04\x7fB\xc5\x1a\xce\xf1\xac1\x077\xa9\x08\x0f%\x94\xa2$l\x84)\xeb\xa0\x96\xe9 \xb8l\xcc\x02\xfb\xd8\x93\xe0\xa7\xc8\x83\xf9\x1c\x12n\xbe>:\x83o\xc2/\xe2\xd3a\ra\t^$rH\xc1\x11""\xe2\x8b#)C\x1c\xbc\xd0\xbc\xe1\x9c\x15\xf5\xc14\x04\xb5\xcbe\xbf\xbe\xe5\xbc\x9dh\xe1\x00C\x10\x07\x98]\xc6hq\x86X\xba\xf6Q\x8b\xf91\xb4\x9cK\xa4\xf9\x01\xd6\x10v<f\x8b[\x1e]\xc0\xec\xe5^\xa6G\x8a\x8ft\x97<\xc0\xe5\x88*`\xde\x86n\x86\x0c`n\x02\xefEa\xe10\x157\t+\x1e\xc8H\xd1q\xff\xa9\x82f3m\x85\xf2\xcb\x84\xdf\x04\x00\xb1\xfe\xb9\xa6\xa1\xadA< \xe1\x88\xefd\x1e\xd0P+\xd3Z\x95\xbd\xde\xc0|\x1c5\xdf\xcb\xa6\xcc\x1e\xf0\x9b\xeaS\xf6\xca\xe6Xi\x0b\xca\x86\xd5\xfd\x99"\xcbV\xda\xf3\x1a^W\xb7\xab\xc8~E\xfa\xec\xd1\xd0A:\xeb\xde\xce\xa1s\xdb\x9c\x9c)S\xa6L\x992e\xca\x94)S\xa6L\x992e\xca\x94)S\xa6L\x99\xfe\xa3\xf4\x7f\x19\xbc\x97\xd5a\xc0\xd7a\x00\x00\x00\x00IEND\xaeB`\x82'

# Add all of the inline images from sub into template.
def handle_inlines(template, sub):
    # rels holds the list of relationships present in the template file.
    rels = template.part.rels
    
    x_path = '//a:blip'
    # blip_list holds a list of all of the a:blip elements in the sub_doc
    blip_list = sub.element.xpath(x_path)

    # shapes holds a list of all the InlineShape objects holding the media
    # of interest
    shapes = sub.inline_shapes

    # Save each image with a unique file path
    for i in range(len(shapes)):

        num_id = random.randint(10000, 100000) 
        
        # Get the rId
        shape = shapes[i]
        if shape._inline.graphic.graphicData.pic:
            rId = shape._inline.graphic.graphicData.pic.blipFill.blip.embed
        else:
            #remove this shape
            drawing_element = shape._inline.getparent()
            drawing_parent = drawing_element.getparent()
            drawing_parent.remove(drawing_element)
            continue
        

        # ImagePart object
        image_part = sub.part.related_parts[rId]

        # Overwrite .emf images
        if image_part.filename[-4:] == '.emf':
            image_blob = EMF_PH
            unique_path = 'image' + str(num_id) + '.' + 'png'

        else:
            # Image object
            actual_image = image_part.image

            # Binary image
            image_blob = actual_image.blob

            # Compose unique filepath str
            unique_path = 'image' + str(num_id) + '.' + actual_image.ext

        # Save blob as image file
        fh = open(unique_path, "wb")
        fh.write(image_blob)
        fh.close()

        # Create the new relationship in the template file for sub_doc's media 
        rId, img = template.part.get_or_add_image(unique_path)
        # rId holds the new rId for the added image
        # img holds the Image object (unused)

        elem = blip_list[i]

        # Sync sub_doc's relationship ID's with the relationships created in
        # the template file
        elem.set('{http://schemas.openxmlformats.org/officeDocument/2006/'
            'relationships}embed', rId)

        # Remove the image file because it's been copied into the template 
        # file's media folder already.
        os.remove(unique_path)